<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title></title>
    <!-- CND -->
    <link href='https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.1.0/fullcalendar.print.min.css' rel='stylesheet'
        media='print' />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.1.0/fullcalendar.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.7/semantic.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <!-- JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.7/semantic.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.17.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.20/js/jquery.dataTables.min.js" type="text/javascript"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.1/js/dataTables.buttons.min.js" type="text/javascript"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap4.min.css" />
    <style>
    .fc-title {
    color: black !important;
    }

    .fc-scroller {
    height: auto !important;
    }

    .fc-head .fc-widget-header {
    margin-right: 0 !important;
    }

    .fc-scroller {
    overflow: visible !important;
    }

    .filter-box {
    width: 25%;
    }

    .form-container {
    padding: 0px;
    float: right !important;
    display: inline-block;
    }
    .dropbtn {
    background-color: #4CAF50;
    color: white;
    padding: 16px;
    font-size: 16px;
    border: none;
    cursor: pointer;
    }

    .dropbtn:hover,
    .dropbtn:focus {
    background-color: #3e8e41;
    }

    .myInput {
    box-sizing: border-box;
    background-image: url('searchicon.png');
    background-position: 14px 12px;
    background-repeat: no-repeat;
    font-size: 16px;
    padding: 14px 20px 12px 45px;
    border: none;
    border-bottom: 1px solid #ddd;
    }

    .myInput:focus {
    outline: 3px solid #ddd;
    }

    #overlayContents {
    width: 100%;
    height: 100%;
    position: absolute;
    background-color: rgba(0, 0, 0, 0.7);
    }

    .dropdown {
    position: relative;
    display: inline-block;
    }

    .dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 230px;
    overflow: auto;
    border: 1px solid #ddd;
    z-index: 1;
    opacity: 10;
    }

    .dropdown-content a {
    color: black;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
    }

    .dropdown a:hover {
    background-color: #ddd;
    }

    .border-style {
    border-radius: 3px;
    }
    .submit-button {
    margin-left: 16px;
    font-size: 18px;
    }
    }
    .show {
    display: block;
    }
    </style>
    
</head>

<body>
  <nav class="navbar navbar-inverse">
    <div class="container-fluid">
      <div class="navbar-header">
	<a class="navbar-brand" href="#">WebSiteName</a>
      </div>
      <ul class="nav navbar-nav">
	<li class="active"><a href="#">Home</a></li>
	<li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">Page 1 <span class="caret"></span></a>
	  <ul class="dropdown-menu">
	    <li><a href="#">Page 1-1</a></li>
	    <li><a href="#">Page 1-2</a></li>
	    <li><a href="#">Page 1-3</a></li>
	  </ul>
	</li>
	<li><a href="#">Page 2</a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
	<li><a href="#"><span class="glyphicon glyphicon-user"></span> Sign Up</a></li>
	<li><a href="#"><span class="glyphicon glyphicon-log-in"></span> Login</a></li>
      </ul>
    </div>
  </nav>
  
  <br />
  <div class="ui container">
    
    <div class="ui grid">
      
      <div class="ui sixteen column">
	
        <div id="buttons-container" class="container ui sixteen column form-container">

	  <div class="dropdown all">

	    <button onclick="myFunction1()" id="selectFile" class="fc-month-button fc-button fc-state-default border-style">
	      Recieved Via
	    </button>

	    <div id="allDropdown" class="dropdown-content" style="z-index: 20;">
	      <input class="myInput" type="text" placeholder="Search.." id="myInput1"
		     onkeyup="filterFunction1()">
	      
	      {% for objects in received_via %}
	      <a href="#" onclick="selectThis(this)">{{ objects }}</a>
	      {%  endfor %}
	      
	    </div>
	    
	  </div>
	  
	  <div class="dropdown data">
	    <button onclick="myFunction2()" class="fc-month-button fc-button fc-state-default border-style"
		    id="occurence">
	      File Type
	    </button>
	    <div id="dataDropdown" class="dropdown-content" style="z-index: 20;">
	      <input class="myInput" type="text" placeholder="Search.." id="myInput2"
		     onkeyup="filterFunction2()">
	      {% for fileType in file_type %}
	      <a href="#" onclick="changeWeekly(this)">{{ fileType }}</a>
	      {%  endfor %}
	    </div>
	  </div>

	  <div class="dropdown yearly">
	    <button onclick="myFunction3(this)"
		    class="fc-month-button fc-button fc-state-default border-style" id="category">
	      Category
	    </button>
	    <div id="yearlyDropdown" class="dropdown-content" style="z-index: 20;">
	      <input class="myInput" type="text" placeholder="Search.." id="myInput3"
		     onkeyup="filterFunction3()">
	      {% for categories in category %}
	      <a href="#" onclick="changeCategory(this)">{{ categories }}</a>
	      {% endfor %}
	    </div>
	  </div>
	  <div class="dropdown">
	    <button class="fc-month-button fc-button fc-state-default border-style submit-button" id="submit-filter">Submit</button>
	  </div>
	  
        </div>
        <br>
	<br>
        <div>
          <table id="table-data" class="table table-bordered table-responsive w-100"></table>
        </div>
	
      </div>
      
    </div>
    
  </div>
  <script>
    function changeCategory(obj) {
    let data = $(obj).html()
    $("#category").html(data);
    document.getElementById("yearlyDropdown").classList.remove("show");
    localStorage.setItem('category', data);
    }
    
    function changeWeekly(obj) {
    let data = $(obj).html()
    $("#occurence").html(data);
    document.getElementById("dataDropdown").classList.remove("show");
    localStorage.setItem('fileType', data);
    }
    
    function selectThis(obj) {
    let data = $(obj).html()
    $("#selectFile").html(data);
    document.getElementById("allDropdown").classList.remove("show");
    localStorage.setItem('receivedVia', data);
    }

    function myFunction1() {
    document.getElementById("dataDropdown").classList.remove("show");
    document.getElementById("yearlyDropdown").classList.remove("show");
    document.getElementById("allDropdown").classList.toggle("show");
    }

    function myFunction2() {
    document.getElementById("allDropdown").classList.remove("show");
    document.getElementById("yearlyDropdown").classList.remove("show");
    document.getElementById("dataDropdown").classList.toggle("show");
    }
    function myFunction3(obj) {
    document.getElementById("allDropdown").classList.remove("show");
    document.getElementById("dataDropdown").classList.remove("show");
    document.getElementById("yearlyDropdown").classList.toggle("show");
    }
    
    function filterFunction1() {
    let input, filter, ul, li, a, i;
    input = document.getElementById("myInput1");
    filter = input.value.toUpperCase();
    div = document.getElementById("allDropdown");
    a = div.getElementsByTagName("a");
    for (i = 0; i < a.length; i++) {
		    txtValue = a[i].textContent || a[i].innerText;
		    if (txtValue.toUpperCase().indexOf(filter) > -1) {
      a[i].style.display = "";
      } else {
      a[i].style.display = "none";
      }
      }
      }
      
      function filterFunction2() {
      let input, filter, ul, li, a, i;
      input = document.getElementById("myInput2");
      filter = input.value.toUpperCase();
      div = document.getElementById("dataDropdown");
      a = div.getElementsByTagName("a");
      for (i = 0; i < a.length; i++) {
		      txtValue = a[i].textContent || a[i].innerText;
		      if (txtValue.toUpperCase().indexOf(filter) > -1) {
	a[i].style.display = "";
	} else {
	a[i].style.display = "none";
	}
	}
	}
	
	function filterFunction3() {
	let input, filter, ul, li, a, i;
	input = document.getElementById("myInput3");
	filter = input.value.toUpperCase();
	div = document.getElementById("yearlyDropdown");
	a = div.getElementsByTagName("a");
	for (i = 0; i < a.length; i++) {
			txtValue = a[i].textContent || a[i].innerText;
			if (txtValue.toUpperCase().indexOf(filter) > -1) {
	  a[i].style.display = "";
	  } else {
	  a[i].style.display = "none";
	  }
	  }
	  }
    $(document).ready(() => {
            let formData = new FormData();
    
            let filename = "{{filename}}";
            let yearly = "{{yearly}}";
            let occurence = "{{occurence}}";

            formData.append('filename', filename)
            formData.append('occurence', occurence)
            formData.append('yearly', yearly)

            //file-name=${fileName ? fileName : ''}&yearly=${yearly ? yearly : ''}&occurence=${occurence ? occurence : ''}`

            let assignments_table = $("#table-data")
            assignments_table.DataTable({
                "processing": true,
                "serverSide": false,
                "ajax": {
                    "url": '/get-table-data',
                    "data": {'file-name': filename, 'yearly': yearly, 'occurence': occurence},
                    dataSrc: "",
                },
                "columns": [
                    {
                        "title": "Source File",
                        "data": "data_file_name",
                    },
                    {
                        "title": "Data File Type",
                        "data": "data_file_type"
                    },
                    {
                        "title": "Received Via",
                        "render": function(data, type, row){
                            return  `<p>---</p>`
                        },
                    },
                    {
                        "title": "Recieved Date",
                        "render": function(data, type, row){
                            return  `<p>---</p>`
                        },
                    },
                    {
                        "title": "Category",
                        "render": function(data, type, row){
                            return  `<p>---</p>`
                        },
                    },
                    {
                        "title": "Total Rows in Source",
                        "render": function(data, type, row){
                            return  `<p>---</p>`
                        },
                    },
                    {
                        "title": "Rows Loaded",
                        "render": function(data, type, row){
                            return  `<p>---</p>`
                        },
                    },
                    {
                        "title": "Rows Failed to Load",
                        "render": function(data, type, row){
                            return  `<p>---</p>`
                        },
                    },
                ],
            });
        });

    </script>
</body>

</html>
